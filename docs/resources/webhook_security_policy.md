---
page_title: "sendgrid_webhook_security_policy Resource - terraform-provider-sendgrid"
subcategory: ""
description: |-
  Manages a SendGrid webhook security policy. Security policies provide authentication mechanisms for webhooks, including OAuth and signature verification.
---

# sendgrid_webhook_security_policy (Resource)

Manages a SendGrid webhook security policy. Security policies provide authentication mechanisms for webhooks, including OAuth and signature verification.

**Important Notes:**

- You must configure at least one authentication method: `oauth`, `signature`, or both
- OAuth configuration requires client credentials and token URL
- Signature verification generates a public key that can be used to verify webhook payloads
- Security policies can be attached to parse webhooks via the `webhook_security_policy_id` field
- Changing `oauth` or `signature` configuration will force recreation of the resource

## Example Usage

```terraform
# OAuth (OIDC) only security policy
resource "sendgrid_webhook_security_policy" "oauth_only" {
  name = "OAuth Policy"

  oauth {
    client_id     = "my-client-id"
    client_secret = "my-client-secret"
    token_url     = "https://oauth.example.com/token"
    scopes        = ["webhooks:read", "webhooks:write"]
  }
}

# Signature verification only security policy
resource "sendgrid_webhook_security_policy" "signature_only" {
  name = "Signature Verification Policy"

  signature {
    enabled = true
  }
}

# The public key can be referenced for verification
output "public_key" {
  value     = sendgrid_webhook_security_policy.signature_only.signature[0].public_key
  sensitive = true
}

# Combined OAuth and Signature security policy
resource "sendgrid_webhook_security_policy" "both" {
  name = "Combined Security Policy"

  oauth {
    client_id     = "my-client-id"
    client_secret = "my-client-secret"
    token_url     = "https://oauth.example.com/token"
    scopes        = ["webhooks:read", "webhooks:write"]
  }

  signature {
    enabled = true
  }
}

# Attached to Parse Webhook
resource "sendgrid_webhook_security_policy" "parse_security" {
  name = "Parse Webhook Security"

  signature {
    enabled = true
  }
}

resource "sendgrid_parse_webhook" "example" {
  hostname                   = "parse.example.com"
  url                        = "https://api.example.com/parse"
  spam_check                 = true
  send_raw                   = false
  webhook_security_policy_id = sendgrid_webhook_security_policy.parse_security.id
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the webhook security policy.

### Optional

- `oauth` (Block List, Max: 1) OAuth configuration for webhook authentication. Can be used together with signature. (see [below for nested schema](#nestedblock--oauth))
- `signature` (Block List, Max: 1) Signature configuration for webhook authentication. Can be used together with oauth. (see [below for nested schema](#nestedblock--signature))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--oauth"></a>
### Nested Schema for `oauth`

Required:

- `client_id` (String) The OAuth client ID.
- `client_secret` (String, Sensitive) The OAuth client secret. This value is sensitive and will not be displayed in logs.
- `scopes` (List of String) List of OAuth scopes required for webhook access.
- `token_url` (String) The OAuth token URL.


<a id="nestedblock--signature"></a>
### Nested Schema for `signature`

Required:

- `enabled` (Boolean) Whether signature verification is enabled for this webhook security policy.

Optional:

- `public_key` (String) The public key used for signature verification. This is computed by SendGrid when signature is enabled.

## Import

Import is supported using the following syntax:

```shell
# Import existing webhook security policy by ID
terraform import sendgrid_webhook_security_policy.example policy_id_here
```

